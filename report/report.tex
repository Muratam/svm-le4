\documentclass[]{jsarticle}
\usepackage[dvipdfmx]{graphicx}
\usepackage[deluxe]{otf}
\renewcommand{\kanjifamilydefault}{\mgdefault}
\newcommand*{\graphc}[3][7.0cm]{\begin{figure}[h] \begin{center}\includegraphics[clip,width= #1]{#2}\caption{#3}\end{center}\end{figure}}
% http://www.ai.soc.i.kyoto-u.ac.jp/~matsubara/le4-2016/index.php?%28Step1%29%20SVM%E3%81%AE%E4%BD%9C%E6%88%90


\begin{document}
\title{平成28年度 3回生後期実験(エージェント) \\ 課題1 SVMの作成 }
\author{村田 叡}
\date{ 2016/10/14 }
\maketitle

\section{プログラム概要}
この課題ではサポートベクターマシン(SVM)のpython3による実装を行った。
1 と -1 の2クラスのサンプル点集合を分類する評価機を生成する。
線形評価関数又はカーネルトリックを用いた評価関数を生成する。
外部ライブラリとして凡庸行列計算に numpy,プロッティングに matplotlib,
二次計画問題の計算に cvxopt を用いた。
以下にその詳細を述べる。


\section{外部仕様}

\subsection{svm.py}
今回のコードは svm.py にて実装した。
このコードは、引数としてサンプル点集合のファイル名、カーネル名、及びオプションをとる。
サンプル点集合の形式については、実験のページに書かれてあるものに従った。
カーネル名は、gauss, polynomial, sigmoid, linear のいずれかをとる。
デフォルトのカーネル名は gauss である。
--plot オプションを使うと結果をmatplotlibでプロットしたものを表示する。

\subsection{実行例と実行結果}
\begin{verbatim}
# 必要なライブラリの導入
$pip3 install -r requirements.txt
# サンプル点集合 sample_circle.dat のガウスカーネルのSVMを作成し、プロッティングする。
$python3 svm.py sample_data/sample_circle.dat -m gauss --plot
>> α : [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00 ...
>> θ : 3.56258579268
>> passed :100 / 100
>> f(x) =  +14.8961965139*K([31.0, 12.0],x) -6.46323001951*K([40.0, 24.0],x) ...
\end{verbatim}
上記のように、各αの値、θの値、サンプル点による識別器の識別率、識別器の関数が結果として得られる。
なお、f(x) の K は 各カーネルを指す。
\graphc[16cm]{./images/circleplot.png}{ガウスカーネルのSVM}


\section{内部仕様}
以下ではsvm.pyでの大域変数と各関数について説明する。

\subsection{kernels}
この大域変数は、各カーネル関数の辞書である。
辞書式のラムダ式で定義しておくことで容易に関数内でコード内で使用できる。
pythonの計算は遅い可能性が高いので、numpyを多用している。

\subsection{solve(x, y, kernel)}
この関数では必要な行列を定義し、ソルバーに渡して二次計画問題を解く。
その結果として得られる、各αの値、θの値、サンプル点による識別器の識別率、識別器の関数を表示する。
この関数の戻り値は識別器 f である。

\subsection{plot\_f(f, x, y,num=100)}
この関数では識別器 f,サンプル点ベクトル集合 x,クラス集合 y,を実際にプロットする作業を行う。
表示区域をnum * num 等分したグリッドスペースと考え,サンプル点とグリッドでのクラスを図示する。

\subsection{load\_x\_y(fileName)}
ファイルからサンプルデータを読み込む関数である。
書式は実験ページのものに従う。

\subsection{parse\_argv()}
コマンドライン引数をパースする関数である。


\section{考察}
実験ページに有る実際のサンプルデータ二種(線形分離可能な集合とそうでない集合)に対して、
100パーセントの分離に成功した。
サンプル数を1から100までに減らした集合の場合でもうまく動作することを確認した。
ガウスカーネル、多項式カーネルともに完璧に分離できたが、シグモイドカーネルはうまく動作しなかった。
理由としては、係数が微妙なのだと考えられるので、うまく動作する係数を探したい。


\end{document}

%ソースコード，プログラム仕様，評価結果を1つのディレクトリにまとめてzipあるいは.tar.gz形式にすること．
%提出先：松原(matsubara@i.kyoto-u.ac.jp)，山本(s-yamamoto@ai.soc.i.kyoto-u.ac.jp)
%課題の提出は一つのメールで教員とTAに同報してください．別メールで送られると，教員TA間での無駄な確認作業が増えます．
%メールのSubjectは，ex4 課題番号 名前（例えば，ex4-1-matsubara）とすること．
%メール本文で自身の名前を名乗ること．本文が何もないと迷惑メールに分類されることがあります．
%△△先生，TA▽▽さん，□□さん，○○です．        　
%課題1を提出します．よろしくお願いします．